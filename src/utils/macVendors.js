/**
 * MAC Address Vendor Identification
 * Common MAC address prefixes (OUI - Organizationally Unique Identifier)
 */

const MAC_VENDORS = {
  // Apple devices
  '00:03:93': 'Apple',
  '00:05:02': 'Apple',
  '00:0a:27': 'Apple (VMware)',
  '00:0a:95': 'Apple',
  '00:0d:93': 'Apple',
  '00:10:fa': 'Apple',
  '00:11:24': 'Apple',
  '00:14:51': 'Apple',
  '00:16:cb': 'Apple',
  '00:17:f2': 'Apple',
  '00:19:e3': 'Apple',
  '00:1b:63': 'Apple',
  '00:1e:c2': 'Apple',
  '00:1f:5b': 'Apple',
  '00:21:e9': 'Apple',
  '00:23:12': 'Apple',
  '00:23:6c': 'Apple',
  '00:23:df': 'Apple',
  '00:25:00': 'Apple',
  '00:25:4b': 'Apple',
  '00:25:bc': 'Apple',
  '00:26:08': 'Apple',
  '00:26:4a': 'Apple',
  '00:26:bb': 'Apple',
  '00:26:ca': 'Apple',
  '00:27:10': 'Apple',
  '00:28:52': 'Apple',
  '00:2a:10': 'Apple',
  '00:50:56': 'VMware',
  '08:00:27': 'VirtualBox',
  'ac:de:48': 'Apple',
  'a4:c3:61': 'Apple',
  'a8:60:b6': 'Apple',
  'a8:96:8a': 'Apple',
  'ac:bc:32': 'Apple',
  'b8:53:ac': 'Apple',
  'bc:52:b7': 'Apple',
  'c0:25:e9': 'Apple',
  'c4:2c:03': 'Apple',
  'cc:08:e0': 'Apple',
  'd0:03:4b': 'Apple',
  'd8:30:62': 'Apple',
  'd8:a2:5e': 'Apple',
  'dc:a9:04': 'Apple',
  'e0:ac:cb': 'Apple',
  'e4:ce:8f': 'Apple',
  'f0:db:e2': 'Apple',
  'f4:f1:5a': 'Apple',
  'f8:1e:df': 'Apple',
  'fc:25:3f': 'Apple',
  
  // Cisco
  '00:00:0c': 'Cisco',
  '00:01:42': 'Cisco',
  '00:01:43': 'Cisco',
  '00:01:63': 'Cisco',
  '00:01:64': 'Cisco',
  '00:01:96': 'Cisco',
  '00:01:97': 'Cisco',
  '00:01:c7': 'Cisco',
  '00:01:c9': 'Cisco',
  '00:02:16': 'Cisco',
  '00:02:3d': 'Cisco',
  '00:02:4a': 'Cisco',
  '00:02:7d': 'Cisco',
  '00:02:fc': 'Cisco',
  '00:03:6b': 'Cisco',
  '00:03:93': 'Cisco',
  '00:04:27': 'Cisco',
  '00:04:9a': 'Cisco',
  '00:05:00': 'Cisco',
  '00:05:01': 'Cisco',
  '00:05:31': 'Cisco',
  '00:05:32': 'Cisco',
  '00:05:5e': 'Cisco',
  '00:05:73': 'Cisco',
  '00:05:9e': 'Cisco',
  '00:05:dc': 'Cisco',
  '00:07:0d': 'Cisco',
  '00:07:85': 'Cisco',
  '00:09:43': 'Cisco',
  '00:0c:29': 'VMware',
  '00:0c:41': 'Cisco',
  '00:0d:29': 'Cisco',
  '00:0d:65': 'Cisco',
  '00:0e:38': 'Cisco',
  '00:0e:84': 'Cisco',
  '00:0f:23': 'Cisco',
  '00:0f:34': 'Cisco',
  '00:0f:8f': 'Cisco',
  '00:10:07': 'Cisco',
  '00:10:11': 'Cisco',
  '00:10:79': 'Cisco',
  '00:11:20': 'Cisco',
  '00:11:21': 'Cisco',
  '00:11:5c': 'Cisco',
  '00:11:92': 'Cisco',
  '00:11:93': 'Cisco',
  '00:11:bb': 'Cisco',
  '00:11:bc': 'Cisco',
  '00:12:00': 'Cisco',
  '00:12:01': 'Cisco',
  '00:12:43': 'Cisco',
  '00:12:7f': 'Cisco',
  '00:12:80': 'Cisco',
  '00:13:19': 'Cisco',
  '00:13:1a': 'Cisco',
  '00:13:5d': 'Cisco',
  '00:13:60': 'Cisco',
  '00:13:7f': 'Cisco',
  '00:13:80': 'Cisco',
  '00:13:c3': 'Cisco',
  '00:14:1b': 'Cisco',
  '00:14:69': 'Cisco',
  '00:14:6a': 'Cisco',
  '00:14:a8': 'Cisco',
  '00:14:f1': 'Cisco',
  '00:15:2b': 'Cisco',
  '00:15:2c': 'Cisco',
  '00:15:c6': 'Cisco',
  '00:15:c7': 'Cisco',
  '00:15:f9': 'Cisco',
  '00:16:46': 'Cisco',
  '00:16:47': 'Cisco',
  '00:16:9c': 'Cisco',
  '00:16:c7': 'Cisco',
  '00:16:d3': 'Cisco',
  '00:17:59': 'Cisco',
  '00:17:94': 'Cisco',
  '00:17:95': 'Cisco',
  '00:17:df': 'Cisco',
  '00:18:19': 'Cisco',
  '00:18:73': 'Cisco',
  '00:18:ba': 'Cisco',
  '00:19:06': 'Cisco',
  '00:19:07': 'Cisco',
  '00:19:2f': 'Cisco',
  '00:19:55': 'Cisco',
  '00:19:aa': 'Cisco',
  '00:19:e7': 'Cisco',
  '00:1a:2b': 'Cisco',
  '00:1a:2c': 'Cisco',
  '00:1a:6c': 'Cisco',
  '00:1a:6d': 'Cisco',
  '00:1a:a1': 'Cisco',
  '00:1a:a2': 'Cisco',
  '00:1b:0c': 'Cisco',
  '00:1b:0d': 'Cisco',
  '00:1b:2a': 'Cisco',
  '00:1b:53': 'Cisco',
  '00:1c:0e': 'Cisco',
  '00:1c:58': 'Cisco',
  '00:1d:45': 'Cisco',
  '00:1d:46': 'Cisco',
  '00:1d:70': 'Cisco',
  '00:1d:7e': 'Cisco',
  '00:1e:13': 'Cisco',
  '00:1e:14': 'Cisco',
  '00:1e:49': 'Cisco',
  '00:1e:79': 'Cisco',
  '00:1e:7d': 'Cisco',
  '00:1e:84': 'Cisco',
  '00:1e:bd': 'Cisco',
  '00:1f:26': 'Cisco',
  '00:1f:6b': 'Cisco',
  '00:1f:6c': 'Cisco',
  '00:1f:9e': 'Cisco',
  '00:1f:c7': 'Cisco',
  '00:21:55': 'Cisco',
  '00:21:56': 'Cisco',
  '00:21:70': 'Cisco',
  '00:21:97': 'Cisco',
  '00:21:a1': 'Cisco',
  '00:21:d1': 'Cisco',
  '00:21:d2': 'Cisco',
  '00:22:55': 'Cisco',
  '00:22:58': 'Cisco',
  '00:23:04': 'Cisco',
  '00:23:33': 'Cisco',
  '00:23:ab': 'Cisco',
  '00:23:ac': 'Cisco',
  '00:23:be': 'Cisco',
  '00:24:14': 'Cisco',
  '00:24:97': 'Cisco',
  '00:24:f7': 'Cisco',
  '00:25:00': 'Cisco',
  '00:25:84': 'Cisco',
  '00:25:9e': 'Cisco',
  '00:26:0b': 'Cisco',
  '00:26:0c': 'Cisco',
  '00:26:98': 'Cisco',
  '00:26:ca': 'Cisco',
  '00:26:f2': 'Cisco',
  '00:27:10': 'Cisco',
  '00:2a:6a': 'Cisco',
  '00:2a:10': 'Cisco',
  
  // Microsoft
  '00:03:ff': 'Microsoft',
  '00:0d:3a': 'Microsoft',
  '00:15:5d': 'Microsoft (Hyper-V)',
  '00:50:f2': 'Microsoft',
  '00:0c:29': 'VMware',
  
  // Intel
  '00:02:b3': 'Intel',
  '00:04:23': 'Intel',
  '00:07:e9': 'Intel',
  '00:0b:db': 'Intel',
  '00:0e:0c': 'Intel',
  '00:11:11': 'Intel',
  '00:13:20': 'Intel',
  '00:13:ce': 'Intel',
  '00:15:17': 'Intel',
  '00:16:ea': 'Intel',
  '00:18:de': 'Intel',
  '00:19:d1': 'Intel',
  '00:1a:92': 'Intel',
  '00:1b:21': 'Intel',
  '00:1c:bf': 'Intel',
  '00:1e:67': 'Intel',
  '00:1f:3c': 'Intel',
  '00:21:5c': 'Intel',
  '00:22:15': 'Intel',
  '00:23:14': 'Intel',
  '00:24:d6': 'Intel',
  '00:26:c6': 'Intel',
  '00:aa:00': 'Intel',
  '00:aa:01': 'Intel',
  '00:aa:02': 'Intel',
  
  // Samsung
  '00:12:fb': 'Samsung',
  '00:15:99': 'Samsung',
  '00:16:32': 'Samsung',
  '00:16:6b': 'Samsung',
  '00:16:db': 'Samsung',
  '00:17:d5': 'Samsung',
  '00:18:af': 'Samsung',
  '00:1c:43': 'Samsung',
  '00:1e:7d': 'Samsung',
  '00:1f:cc': 'Samsung',
  '00:21:4c': 'Samsung',
  '00:23:39': 'Samsung',
  '00:23:6d': 'Samsung',
  '00:24:54': 'Samsung',
  '00:25:38': 'Samsung',
  'ac:5a:14': 'Samsung',
  'b0:df:3a': 'Samsung',
  'cc:f9:e8': 'Samsung',
  'd0:22:be': 'Samsung',
  'd4:6e:5c': 'Samsung',
  'e0:50:8b': 'Samsung',
  'f0:25:b7': 'Samsung',
  
  // HP
  '00:01:e6': 'HP',
  '00:03:0d': 'HP',
  '00:08:74': 'HP',
  '00:0b:cd': 'HP',
  '00:0c:29': 'HP',
  '00:0e:7f': 'HP',
  '00:0f:20': 'HP',
  '00:11:0a': 'HP',
  '00:11:85': 'HP',
  '00:13:21': 'HP',
  '00:15:60': 'HP',
  '00:17:a4': 'HP',
  '00:18:71': 'HP',
  '00:1a:4b': 'HP',
  '00:1b:78': 'HP',
  '00:1e:0b': 'HP',
  '00:1f:29': 'HP',
  '00:21:5a': 'HP',
  '00:23:7d': 'HP',
  '00:24:81': 'HP',
  '00:26:55': 'HP',
  
  // Dell
  '00:14:22': 'Dell',
  '00:18:8b': 'Dell',
  '00:1b:21': 'Dell',
  '00:1e:c9': 'Dell',
  '00:21:70': 'Dell',
  '00:24:e8': 'Dell',
  '00:26:b9': 'Dell',
  'b8:ac:6f': 'Dell',
  'f0:1f:af': 'Dell',
  
  // TP-Link
  '00:27:19': 'TP-Link',
  '00:27:22': 'TP-Link',
  '50:c7:bf': 'TP-Link',
  '64:16:66': 'TP-Link',
  '80:1f:02': 'TP-Link',
  'a0:f3:c1': 'TP-Link',
  'c4:6e:1f': 'TP-Link',
  'e0:05:c5': 'TP-Link',
  'f4:ec:38': 'TP-Link',
  
  // Netgear
  '00:09:5b': 'Netgear',
  '00:0f:b5': 'Netgear',
  '00:14:6c': 'Netgear',
  '00:1b:2f': 'Netgear',
  '00:1e:2a': 'Netgear',
  '00:24:b2': 'Netgear',
  '20:4e:7f': 'Netgear',
  '28:c6:8e': 'Netgear',
  '2c:b0:5d': 'Netgear',
  '6c:fd:b9': 'Netgear',
  '84:1b:5e': 'Netgear',
  'a0:63:91': 'Netgear',
  'c0:3f:0e': 'Netgear',
  'e0:46:9a': 'Netgear',
  
  // Linksys
  '00:0f:66': 'Linksys',
  '00:12:17': 'Linksys',
  '00:13:10': 'Linksys',
  '00:14:bf': 'Linksys',
  '00:16:b6': 'Linksys',
  '00:18:39': 'Linksys',
  '00:19:70': 'Linksys',
  '00:1a:70': 'Linksys',
  '00:1b:11': 'Linksys',
  '00:1c:df': 'Linksys',
  '00:1d:7e': 'Linksys',
  '00:1e:e5': 'Linksys',
  '00:21:29': 'Linksys',
  '00:23:69': 'Linksys',
  '00:24:36': 'Linksys',
  '00:25:9c': 'Linksys',
  '00:26:24': 'Linksys',
  
  // Google
  '00:1a:11': 'Google',
  '3c:5a:b4': 'Google',
  '6c:ad:f8': 'Google',
  '84:fc:fe': 'Google',
  'd8:eb:97': 'Google',
  'f4:f5:e8': 'Google',
  
  // Amazon
  '00:fc:58': 'Amazon',
  '0c:47:c9': 'Amazon',
  '44:65:0d': 'Amazon',
  '50:f5:da': 'Amazon',
  '68:37:e9': 'Amazon',
  '74:c2:46': 'Amazon',
  'a0:02:dc': 'Amazon',
  'ac:63:be': 'Amazon',
  'f0:27:2d': 'Amazon',
  
  // Raspberry Pi
  'b8:27:eb': 'Raspberry Pi',
  'dc:a6:32': 'Raspberry Pi',
  'e4:5f:01': 'Raspberry Pi',
  
  // Ubiquiti
  '24:a4:3c': 'Ubiquiti',
  '44:d9:e7': 'Ubiquiti',
  '68:72:51': 'Ubiquiti',
  '78:8d:de': 'Ubiquiti',
  '80:2a:a8': 'Ubiquiti',
  'ac:8d:34': 'Ubiquiti',
  'b4:fb:e4': 'Ubiquiti',
  'd4:57:63': 'Ubiquiti',
  'f0:9f:c2': 'Ubiquiti',
  
  // Sony
  '00:13:a9': 'Sony',
  '00:16:fe': 'Sony',
  '00:19:c5': 'Sony',
  '00:1a:80': 'Sony',
  '00:1d:0d': 'Sony',
  '00:1e:45': 'Sony',
  '00:21:9b': 'Sony',
  '00:24:be': 'Sony',
  'ac:9b:0a': 'Sony',
  'cc:fb:65': 'Sony',
  
  // LG
  '00:1e:75': 'LG',
  '00:26:e2': 'LG',
  '5c:0a:5b': 'LG',
  '60:f2:62': 'LG',
  '7c:1e:52': 'LG',
  'a4:5e:60': 'LG',
  'c8:bc:c8': 'LG',
  'e0:50:8b': 'LG',
  
  // Huawei
  '00:1e:10': 'Huawei',
  '00:46:4b': 'Huawei',
  '00:e0:fc': 'Huawei',
  '28:6e:d4': 'Huawei',
  '30:87:30': 'Huawei',
  '54:89:98': 'Huawei',
  '6c:9c:ed': 'Huawei',
  '80:fb:06': 'Huawei',
  'a4:99:47': 'Huawei',
  'c8:4c:75': 'Huawei',
  'e0:24:7f': 'Huawei',
  'f8:a4:5f': 'Huawei',
  
  // Xiaomi
  '28:e3:1f': 'Xiaomi',
  '34:ce:00': 'Xiaomi',
  '50:64:2b': 'Xiaomi',
  '64:09:80': 'Xiaomi',
  '78:f5:57': 'Xiaomi',
  'ac:f7:f3': 'Xiaomi',
  'c4:6e:1f': 'Xiaomi',
  'f0:b4:29': 'Xiaomi',
  'fc:64:ba': 'Xiaomi',
};

/**
 * Get MAC address vendor from MAC address
 * @param {string} macAddress - MAC address in format XX:XX:XX:XX:XX:XX
 * @returns {string|null} Vendor name or null if not found
 */
export function getMacVendor(macAddress) {
  if (!macAddress) return null;
  
  // Normalize MAC address (uppercase, handle different separators)
  const normalized = macAddress.toUpperCase().replace(/[-:]/g, ':');
  
  // Extract first 3 octets (OUI)
  const oui = normalized.split(':').slice(0, 3).join(':');
  
  return MAC_VENDORS[oui] || null;
}

/**
 * Format MAC address consistently
 * @param {string} macAddress - MAC address in any format
 * @returns {string} Formatted MAC address (XX:XX:XX:XX:XX:XX)
 */
export function formatMacAddress(macAddress) {
  if (!macAddress) return '';
  
  // Remove all separators and convert to uppercase
  const cleaned = macAddress.replace(/[-:.\s]/g, '').toUpperCase();
  
  // Add colons every 2 characters
  return cleaned.match(/.{1,2}/g)?.join(':') || macAddress;
}

